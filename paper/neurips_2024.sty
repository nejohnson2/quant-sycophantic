% NeurIPS 2024 Style File
% Based on official NeurIPS template

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{neurips_2024}[2024/01/01 NeurIPS 2024 Style]

% Options
\newif\if@final\@finalfalse
\DeclareOption{final}{\@finaltrue}
\newif\if@preprint\@preprintfalse
\DeclareOption{preprint}{\@preprinttrue}
\ProcessOptions\relax

% Page layout
\usepackage[letterpaper,
            textwidth=6.5in,
            textheight=9in,
            marginparwidth=0.5in,
            top=1in]{geometry}

% Fonts
\usepackage{times}
\usepackage{mathptmx}

% Line spacing
\renewcommand{\baselinestretch}{1.0}

% Section formatting
\usepackage{titlesec}
\titleformat{\section}{\normalfont\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\normalfont\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\normalfont\normalsize\bfseries}{\thesubsubsection}{1em}{}
\titlespacing*{\section}{0pt}{2.5ex plus 1ex minus .2ex}{1.3ex plus .2ex}
\titlespacing*{\subsection}{0pt}{2.25ex plus 1ex minus .2ex}{1ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{2ex plus 1ex minus .2ex}{0.75ex plus .2ex}

% Paragraph formatting
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}

% Title formatting
\newcommand{\@neurips@maketitle}{%
  \begin{center}%
    {\LARGE\bfseries \@title \par}%
    \vskip 1.5em%
    {\large
      \lineskip .5em%
      \begin{tabular}[t]{c}%
        \@author
      \end{tabular}\par}%
  \end{center}%
  \par
  \vskip 1.5em%
}

\renewcommand{\maketitle}{%
  \par
  \begingroup
  \renewcommand\thefootnote{\@fnsymbol\c@footnote}%
  \def\@makefnmark{\rlap{\@textsuperscript{\normalfont\@thefnmark}}}%
  \long\def\@makefntext##1{\parindent 1em\noindent
    \hb@xt@1.8em{%
    \hss\@textsuperscript{\normalfont\@thefnmark}}##1}%
  \@neurips@maketitle
  \@thanks
  \endgroup
  \setcounter{footnote}{0}%
}

% Abstract formatting
\renewenvironment{abstract}{%
  \centerline{\large\bfseries Abstract}%
  \vspace{0.5ex}%
  \begin{quote}%
}{%
  \end{quote}%
}

% Acknowledgments environment
\newenvironment{ack}{%
  \section*{Acknowledgments}%
}{%
}

% Citation style
\usepackage{natbib}
\setcitestyle{authoryear,round,citesep={;},aysep={,},yysep={;}}

% Hyperref setup (load last typically, but we set it up here)
\AtBeginDocument{%
  \@ifpackageloaded{hyperref}{%
    \hypersetup{
      colorlinks=true,
      linkcolor=blue,
      citecolor=blue,
      urlcolor=blue,
      pdfborder={0 0 0}
    }%
  }{}%
}

% Headers/footers
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\if@final
  \fancyfoot[C]{\thepage}
\else
  \fancyhead[C]{\textit{Preprint. Under review.}}
  \fancyfoot[C]{\thepage}
\fi

% First page style
\fancypagestyle{firstpage}{%
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  \if@final
    \fancyfoot[C]{\thepage}
  \else
    \fancyhead[C]{\textit{Preprint. Under review.}}
    \fancyfoot[C]{\thepage}
  \fi
}
\thispagestyle{firstpage}

\endinput
